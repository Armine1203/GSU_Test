{% extends 'layout.html' %}

{% block title %}Հարցերի բեռնում{% endblock %}

{% block body %}
<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card shadow">
                <div class="card-header bg-primary text-white">
                    <h4 class="mb-0">CSV ֆայլով հարցերի բեռնում</h4>
                </div>

                <div class="card-body">
                    <form method="post" enctype="multipart/form-data">
                        {% csrf_token %}

                        <!-- Subject Selection -->
                        <div class="mb-3">
                            <label for="subjectSelect" class="form-label">Առարկա</label>
                            <select class="form-select" id="subjectSelect" name="subject" required>
                                {% if subjects %}
                                    <option value="" selected disabled>Ընտրեք առարկան</option>
                                    {% for subject in subjects %}
                                        <option value="{{ subject.id }}">
                                            {{ subject.name }} ({{ subject.major.name }})
                                        </option>
                                    {% endfor %}
                                {% else %}
                                    <option value="" selected disabled>Հասանելի առարկաներ չկան</option>
                                {% endif %}
                            </select>
                            {% if not subjects %}
                                <div class="alert alert-warning mt-2">
                                    Դուք չունեք հասանելի առարկաներ: Խնդրում ենք դիմել ադմինիստրացիային:
                                </div>
                            {% endif %}
                        </div>

                        <!-- File Upload -->
                        <div class="mb-3">
                            <label for="csvFile" class="form-label">CSV ֆայլ</label>
                            <input class="form-control" type="file" id="csvFile" name="qFile" accept=".csv" required>
                            <div class="form-text">
                                Ընտրեք CSV ֆայլը, որը պարունակում է հարցերը
                            </div>
                        </div>

                        <button type="submit" class="btn btn-success w-100" {% if not subjects %}disabled{% endif %}>
                            <i class="bi bi-upload me-2"></i> Բեռնել հարցերը
                        </button>
                    </form>
                </div>
            </div>

            <!-- CSV Format Instructions -->
            <div class="card mt-4 shadow-sm">
                <div class="card-header bg-info text-white">
                    <h5 class="mb-0">CSV ֆայլի ձևաչափ</h5>
                </div>
                <div class="card-body">
                    <p>Ձեր CSV ֆայլը պետք է ունենա հետևյալ սյունակները՝</p>

                    <div class="table-responsive">
                        <table class="table table-bordered">
                            <thead class="table-light">
                                <tr>
                                    <th>Հարց</th>
                                    <th>Տարբերակ 1</th>
                                    <th>Տարբերակ 2</th>
                                    <th>Տարբերակ 3</th>
                                    <th>Տարբերակ 4</th>
                                    <th>Ճիշտ պատասխան</th>
                                    <th>Միավոր</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Ո՞րն է Հայաստանի մայրաքաղաքը</td>
                                    <td>Երևան</td>
                                    <td>Մոսկվա</td>
                                    <td>Տոկիո</td>
                                    <td>Փարիզ</td>
                                    <td>A</td>
                                    <td>1</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="alert alert-secondary mt-3">
                        <strong>Նշումներ:</strong>
                        <ul class="mb-0">
                            <li>Ճիշտ պատասխանը պետք է լինի <code>A</code>, <code>B</code>, <code>C</code> կամ <code>D</code></li>
                            <li>Միավորը պետք է լինի ամբողջ թիվ (լռելյայն 1)</li>
                            <li>Ֆայլը պետք է պարունակի վերնագիր տող(Սյունակների անունները)</li>

                        </ul>
                    </div>
                            <span>Օրինակը տեսնելու համար ներբեռնեք ֆայլի օրինակը՝  </span>

                    <a href="{% url 'download_question_template' %}" class="btn btn-outline-primary mt-2">
                        <i class="bi bi-download me-2"></i> Ներբեռնել CSV ֆայլի օրինակ
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}